/*@ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 **
 **   Project      : MAGEMin
 **   License      : GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007
 **   Developers   : Nicolas Riel, Boris Kaus
 **   Contributors : Dominguez, H., Assunção J., Green E., Berlie N., and Rummel L.
 **   Organization : Institute of Geosciences, Johannes-Gutenberg University, Mainz
 **   Contact      : nriel[at]uni-mainz.de, kaus[at]uni-mainz.de
 **
 ** ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ @*/
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <complex.h> 

#include "SB_endmembers.h"

/* SiO2:0 CaO:1 Al2O3:2 FeO:3 MgO:4 Na2O:5 */
EM_db_sb arr_em_db_sb_sb11[46] = {
    {
        "ab", "albite", "[Na_1]Al_1Si_3O_8",
        {3.0, 0.0, 0.5, 0.0, 0.0, 0.5},
        {-3.718799e6, -13.0, -10.0452, 597616.2, 4.0, 713.7824, 0.56704, 1.0, 1.04208, 0.0},
        {36.0,1.38571,1.02978},
    },
    {
        "an", "anorthite", "[Ca_1]Al_2Si_2O_8",
        {2.0, 1.0, 1.0, 0.0, 0.0, 0.0},
        {-4.014619e6, -13.0, -10.061, 840891.5, 4.0, 752.3911, 0.39241, 1.0, 1.6254, 0.0},
        {39.9,1.09129,1.63323},
    },
    {
        "sp", "spinel", "[Mg_3Al_1][Al_7Mg_1]O_16",
        {0.0, 0.0, 4.0, 0.0, 4.0, 0.0},
        {-8.667568e6, -28.0, -15.9048, 1.969428e6, 5.68282, 842.8104, 1.02283, 2.71208, 2.66282, 43.76},
        {109.0,0.62792,2.44263},
    },
    {
        "hc", "hercynite", "[Fe_3Al_1][Al_7Fe_1]O_16",
        {0.0, 0.0, 4.0, 4.0, 0.0, 0.0},
        {-7.324009e6, -28.0, -16.3372, 2.088965e6, 5.68282, 763.231, 1.21719, 2.71208, 2.768, 97.28},
        {84.5,0.62792,2.49369},
    },
    {
        "fo", "forsterite", "[Mg_2]Si_1O_4",
        {1.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.055403e6, -7.0, -4.3603, 1.279555e6, 4.21796, 809.1703, 0.99282, 2.10672, 2.29972, 0.0},
        {81.6,1.46257,2.29968},
    },
    {
        "fa", "fayalite", "[Fe_2]Si_1O_4",
        {1.0, 0.0, 0.0, 2.0, 0.0, 0.0},
        {-1.370519e6, -7.0, -4.629, 1.349622e6, 4.21796, 618.7007, 1.06023, 3.6466, 1.02497, 26.76},
        {51.22,0.85893,1.65937},
    },
    {
        "mgwa", "mg-wadsleyite", "[Mg_2]Si_1O_4",
        {1.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.027837e6, -7.0, -4.0515, 1.686948e6, 4.3229, 843.4973, 1.2061, 2.0188, 2.63683, 0.0},
        {112.0,1.50973,2.56133},
    },
    {
        "fewa", "fe-wadsleyite", "[Fe_2]Si_1O_4",
        {1.0, 0.0, 0.0, 2.0, 0.0, 0.0},
        {-1.364668e6, -7.0, -4.28, 1.68591e6, 4.3229, 665.4492, 1.2061, 2.0188, 1.04017, 26.76},
        {81.47,1.90552,5.99521},
    },
    {
        "mgri", "mg-ringwoodite", "[Mg_2]Si_1O_4",
        {1.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.017557e6, -7.0, -3.9493, 1.849009e6, 4.22035, 877.7094, 1.10791, 2.3914, 2.30461, 0.0},
        {123.0,1.35412,2.30288},
    },
    {
        "feri", "fe-ringwoodite", "[Fe_2]Si_1O_4",
        {1.0, 0.0, 0.0, 2.0, 0.0, 0.0},
        {-1.362772e6, -7.0, -4.186, 2.13412e6, 4.22035, 677.7177, 1.27193, 2.3914, 1.77249, 26.76},
        {92.0,1.35412,1.77066},
    },
    {
        "en", "enstatite", "[Mg_1][Mg_1]Si_2O_6",
        {2.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.913596e6, -10.0, -6.2676, 1.070768e6, 7.02751, 812.1848, 0.78479, 3.43846, 2.50453, 0.0},
        {76.8,1.54596,2.5045},
    },
    {
        "fs", "ferrosilite", "[Fe_1][Fe_1]Si_2O_6",
        {2.0, 0.0, 0.0, 2.0, 0.0, 0.0},
        {-2.225718e6, -10.0, -6.5941, 1.005386e6, 7.02751, 674.4769, 0.71889, 3.43846, 1.07706, 26.76},
        {52.0,1.54596,1.08309},
    },
    {
        "mgts", "mg-tschermak", "[Mg_1][Al_1]Si_1Al_1O_6",
        {1.0, 0.0, 1.0, 0.0, 1.0, 0.0},
        {-3.00247e6, -10.0, -5.914, 1.070768e6, 7.02751, 783.8404, 0.78479, 3.43846, 2.49099, 0.0},
        {93.47146,1.54596,2.39416},
    },
    {
        "odi", "ortho-diopside", "[Ca_1][Mg_1]Si_2O_6",
        {2.0, 1.0, 0.0, 0.0, 1.0, 0.0},
        {-3.015827e6, -10.0, -6.8054, 1.070768e6, 7.02751, 744.6988, 0.78479, 3.43846, 1.36161, 0.0},
        {57.50875,1.54596,1.31909},
    },
    {
        "di", "diopside", "[Ca_1][Mg_1][Si_2]O_6",
        {2.0, 1.0, 0.0, 0.0, 1.0, 0.0},
        {-3.029531e6, -10.0, -6.6039, 1.122413e6, 5.23885, 781.6146, 0.95873, 1.52852, 1.57351, 0.0},
        {72.7,1.71384,1.06175},
    },
    {
        "he", "hedenbergite", "[Ca_1][Fe_1][Si_2]O_6",
        {2.0, 1.0, 0.0, 1.0, 0.0, 0.0},
        {-2.67733e6, -10.0, -6.7867, 1.192555e6, 5.23885, 701.5851, 0.93516, 1.52852, 1.5703, 13.38},
        {61.0,1.71384,1.01745},
    },
    {
        "cen", "clinoenstatite", "[Mg_1][Mg_1][Si_2]O_6",
        {2.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.905918e6, -10.0, -6.25, 1.122413e6, 5.23885, 805.0547, 0.95873, 1.52852, 1.69074, 0.0},
        {76.97036,1.71384,1.43121},
    },
    {
        "cats", "ca-tschermak", "[Ca_1][Al_1][Si_1Al_1]O_6",
        {1.0, 1.0, 1.0, 0.0, 0.0, 0.0},
        {-3.120253e6, -10.0, -6.3574, 1.122413e6, 5.23885, 803.6626, 0.78126, 1.52852, 1.9672, 11.525},
        {74.42499,1.71384,1.73383},
    },
    {
        "jd", "jadeite", "[Na_1][Al_1][Si_2]O_6",
        {2.0, 0.0, 0.5, 0.0, 0.0, 0.5},
        {-2.855192e6, -10.0, -6.0508, 1.422873e6, 5.23885, 820.7623, 0.903, 0.39234, 2.18453, 0.0},
        {85.0,1.71384,1.88167},
    },
    {
        "hpcen", "hp-clinoenstatite", "[Mg_2]Si_2O_6",
        {2.0, 0.0, 0.0, 0.0, 2.0, 0.0},
        {-2.905788e6, -10.0, -6.076, 1.160254e6, 6.23685, 824.4439, 1.12473, 0.20401, 2.14181, 0.0},
        {76.97036,1.71384,1.43121},
    },
    {
        "hpcfs", "hp-clinoferrosilite", "[Fe_2]Si_2O_6",
        {2.0, 0.0, 0.0, 2.0, 0.0, 0.0},
        {-2.222183e6, -10.0, -6.385413, 1.160254e6, 6.23685, 691.564, 1.12473, 0.20401, 0.79216, 26.76},
        {52.0,1.54596,1.08309},
    },
    {
        "capv", "ca-perovskite", "Ca_1Si_1O_3",
        {1.0, 1.0, 0.0, 0.0, 0.0, 0.0},
        {-1.463358e6, -5.0, -2.745, 2.36e6, 3.9, 795.779, 1.88839, 0.89769, 1.28818, 0.0},
        {155.20524,2.22637,1.23493},
    },
    {
        "mgak", "mg-akimotoite", "[Mg_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 0.0, 1.0, 0.0},
        {-1.41085e6, -5.0, -2.6354, 2.10706e6, 5.62088, 935.9778, 1.18984, 2.34514, 2.80782, 0.0},
        {132.0,1.81492,3.40174},
    },
    {
        "feak", "fe-akimotoite", "[Fe_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 1.0, 0.0, 0.0},
        {-1.067598e6, -5.0, -2.6854, 2.10706e6, 5.62088, 887.8709, 1.18984, 2.34514, 3.5716, 13.38},
        {160.83357,1.81492,3.43813},
    },
    {
        "co", "corundum", "[Al_1][Al_1]O_3",
        {0.0, 0.0, 1.0, 0.0, 0.0, 0.0},
        {-1.582454e6, -5.0, -2.5577, 2.525457e6, 4.33728, 932.5696, 1.32442, 1.30316, 2.8316, 0.0},
        {163.2,1.81492,2.63052},
    },
    {
        "py", "pyrope", "[Mg_3][Al_1][Al_1]Si_3O_12",
        {3.0, 0.0, 1.0, 0.0, 3.0, 0.0},
        {-5.936538e6, -20.0, -11.308, 1.702396e6, 4.11067, 823.2102, 1.01424, 1.42169, 0.98186, 0.0},
        {93.7,1.35756,0.98186},
    },
    {
        "alm", "almandine", "[Fe_3][Al_1][Al_1]Si_3O_12",
        {3.0, 0.0, 1.0, 3.0, 0.0, 0.0},
        {-4.935516e6, -20.0, -11.543, 1.738963e6, 4.91341, 741.356, 1.06495, 1.42169, 2.09292, 40.14},
        {96.0,1.40927,2.09289},
    },
    {
        "gr", "grossular", "[Ca_3][Al_1][Al_1]Si_3O_12",
        {3.0, 3.0, 1.0, 0.0, 0.0, 0.0},
        {-6.277935e6, -20.0, -12.512, 1.670622e6, 3.91544, 822.743, 1.05404, 1.88887, 2.38418, 0.0},
        {109.0,1.16274,2.38415},
    },
    {
        "mgmj", "mg-majorite", "[Mg_3][Mg_1][Si_1]Si_3O_12",
        {4.0, 0.0, 0.0, 0.0, 4.0, 0.0},
        {-5.691614e6, -20.0, -11.4324, 1.651183e6, 4.21183, 822.458, 0.97682, 1.53581, 1.0178, 0.0},
        {85.0,1.42969,1.01779},
    },
    {
        "jdmj", "jd-majorite", "[Na_2Al_1][Al_1][Si_1]Si_3O_12",
        {4.0, 0.0, 1.0, 0.0, 0.0, 1.0},
        {-5.518542e6, -20.0, -11.094, 1.770772e6, 4.11067, 895.914, 1.01424, 1.42169, 3.30517, 0.0},
        {114.7,1.35756,2.4849},
    },
    {
        "qtz", "quartz", "Si_1O_2",
        {1.0, 0.0, 0.0, 0.0, 0.0, 0.0},
        {-858853.4, -3.0, -2.367003, 495474.3, 4.33155, 816.3307, -0.00296, 1.0, 2.367003, 0.0},
        {44.85776,-0.04277,2.40509},
    },
    {
        "coe", "coesite", "Si_1O_2",
        {1.0, 0.0, 0.0, 0.0, 0.0, 0.0},
        {-855068.5, -3.0, -2.0657, 1.135856e6, 4.0, 852.4267, 0.39157, 1.0, 2.39793, 0.0},
        {61.6,0.49686,2.75988},
    },
    {
        "st", "stishovite", "Si_1O_2",
        {1.0, 0.0, 0.0, 0.0, 0.0, 0.0},
        {-818984.6, -3.0, -1.4017, 3.143352e6, 3.75122, 1107.824, 1.37466, 2.83517, 4.60904, 0.0},
        {228.0,1.94045,4.40394},
    },
    {
        "mgpv", "mg-perovskite", "[Mg_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 0.0, 1.0, 0.0},
        {-1.368283e6, -5.0, -2.4445, 2.505264e11, 4.14, 905.9412, 1.56508, 1.10945, 2.56536, 0.0},
        {172.9,1.73259,1.65573},
    },
    {
        "fepv", "fe-perovskite", "[Fe_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 1.0, 0.0, 0.0},
        {-1.04092e6, -5.0, -2.5485, 2.721152e11, 4.14, 870.8122, 1.56508, 1.10945, 2.29211, 13.38},
        {130.02098,1.37254,2.0941},
    },
    {
        "alpv", "al-perovskite", "[Al_1][Al_1]O_3",
        {0.0, 0.0, 1.0, 0.0, 0.0, 0.0},
        {-1.533878e6, -5.0, -2.4944, 2.582e11, 4.14, 886.4601, 1.56508, 1.10945, 2.47126, 0.0},
        {169.19962,1.55703,2.2751},
    },
    {
        "mppv", "mg-post-perovskite", "[Mg_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 0.0, 1.0, 0.0},
        {-1.348641e6, -5.0, -2.4419, 2.312e6, 4.0, 855.8173, 1.89155, 1.09081, 1.16704, 0.0},
        {171.13587,1.85188,1.2881},
    },
    {
        "fppv", "fe-post-perovskite", "[Fe_1][Si_1]O_3",
        {1.0, 0.0, 0.0, 1.0, 0.0, 0.0},
        {-981806.9, -5.0, -2.5459, 2.312e6, 4.0, 781.3465, 1.89155, 1.09081, 1.36382, 13.38},
        {129.5,1.31526,1.72601},
    },
    {
        "appv", "al-post-perovskite", "[Al_1][Al_1]O_3",
        {0.0, 0.0, 1.0, 0.0, 0.0, 0.0},
        {-1.377582e6, -5.0, -2.3847, 2.49e6, 4.0, 762.1951, 1.64573, 1.09081, 2.83762, 0.0},
        {91.96526,1.81603,2.52605},
    },
    {
        "pe", "periclase", "[Mg_1]O_1",
        {0.0, 0.0, 0.0, 0.0, 1.0, 0.0},
        {-569444.6, -2.0, -1.1244, 1.613836e6, 3.84045, 767.0977, 1.36127, 1.7217, 2.81765, 0.0},
        {130.9,2.14668,2.56123},
    },
    {
        "wu", "wustite", "[Fe_1]O_1",
        {0.0, 0.0, 0.0, 1.0, 0.0, 0.0},
        {-242146.0, -2.0, -1.2264, 1.794442e6, 4.9376, 454.1592, 1.53047, 1.7217, -0.05731, 13.38},
        {59.0,1.44764,0.06776},
    },
    {
        "mgcf", "mg-ca-ferrite", "[Mg_1][Al_1]Al_1O_4",
        {0.0, 0.0, 1.0, 0.0, 1.0, 0.0},
        {-2.122169e6, -7.0, -3.6177, 2.106663e6, 4.0528, 838.6291, 1.31156, 1.0, 2.1073, 0.0},
        {129.7,1.93591,1.30302},
    },
    {
        "fecf", "fe-ca-ferrite", "[Fe_1][Al_1]Al_1O_4",
        {0.0, 0.0, 1.0, 1.0, 0.0, 0.0},
        {-1.790284e6, -7.0, -3.7258, 2.106663e6, 4.0528, 804.1986, 1.31156, 1.0, 3.0268, 13.38},
        {159.70965,1.93591,2.34163},
    },
    {
        "nacf", "na-ca-ferrite", "[Na_1][Si_1]Al_1O_4",
        {1.0, 0.0, 0.5, 0.0, 0.0, 0.5},
        {-1.844129e6, -7.0, -3.627, 1.613385e6, 4.32479, 812.4769, 0.69428, 1.0, 2.79016, 0.0},
        {135.32662,1.93591,1.36827},
    },
    {
        "ky", "kyanite", "Al_2Si_1O_5",
        {1.0, 0.0, 1.0, 0.0, 0.0, 0.0},
        {-2.446058e6, -8.0, -4.4227, 1.6e6, 4.0, 943.1665, 0.9255, 1.0, 2.96665, 0.0},
        {117.85453,1.69416,2.90375},
    },
    {
        "neph", "nepheline", "Na_1Al_1Si_1O_4",
        {1.0, 0.0, 0.5, 0.0, 0.0, 0.5},
        {-1.992104e6, -7.0, -5.46684, 530779.9, 4.0, 700.9422, 0.69428, 1.0, 0.6291, 0.0},
        {30.7,1.33087,0.6241},
    },
};

/* Select required thermodynamic database */
EM_db_sb Access_SB_EM_DB(int id, int EM_dataset) {
	EM_db_sb Entry_EM;

	if (EM_dataset == 2011){	
	 	Entry_EM = arr_em_db_sb_sb11[id]; 
	}
	else{
		printf(" Wrong endmember dataset, values should be 2011 or 2024\n");
		printf(" -> using default 2011 to avoid ugly crash\n");
		Entry_EM = arr_em_db_sb_sb11[id]; 
	}
	
	return Entry_EM;
}
